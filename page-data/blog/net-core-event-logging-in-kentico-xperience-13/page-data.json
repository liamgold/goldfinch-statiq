{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/net-core-event-logging-in-kentico-xperience-13/","result":{"data":{"kontentItemBlogDetail":{"elements":{"url_slug":{"value":"net-core-event-logging-in-kentico-xperience-13"},"base__title":{"value":".NET Core event logging in Kentico Xperience 13"},"base__teaser_image":{"value":[{"url":"https://assets-us-01.kc-usercontent.com:443/1bb6bba8-9f04-4be8-88c3-46cbb47bbc97/d465e236-e86a-43a1-bd25-4dee327052f8/User%20is%20not%20authorized.jpeg"}]},"seo__meta_title":{"value":".NET Core event logging in Kentico Xperience 13"},"seo__meta_description":{"value":"Learn about the Kentico Xperience implementation of the .NET Core logging API."},"seo__canonical_url":{"value":""},"body_copy":{"value":"<p>When Kentico Xperience 13 was launched, we gained the ability to build websites using ASP.NET Core üòÅ. &nbsp;Behind the scenes, a lot of Xperience's core libraries had to be rewritten and migrated, so that they were compatible with .NET Core.</p>\n<p>When creating a new Xperience site using .NET Core, you'll need to ensure you are <a href=\"https://docs.xperience.io/developing-websites/developing-xperience-applications-using-asp-net-core/starting-with-asp-net-core-development#StartingwithASP.NETCoredevelopment-Configuringapplicationstartup\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">registering</a> the services correctly in the application's Startup<strong> </strong>class.</p>\n<p><strong>Event logging in .NET Core</strong></p>\n<p>One of the features introduced by the AddKentico() service is the KenticoEventLog logger. &nbsp;This logger introduces the ability to <a href=\"https://docs.xperience.io/13api/configuration/event-log#Eventlog-Loggingevents\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">log events</a> from the .NET Core website, and displays them in the Event Log module within the admin site. &nbsp;You can log error messages, exceptions, warnings or even just debug information to assist with troubleshooting problems. &nbsp;The logger itself is built using the <a href=\"https://docs.microsoft.com/aspnet/core/fundamentals/logging/?view=aspnetcore-3.1\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">.NET Core logging API</a>, so it should be easy to use and recognisable by ASP.NET Core developers.</p>\n<p>However, this is where we hit a problem - the current implementation of the KenticoEventLog logger doesn't appear to fully recognise values set in the website appsettings.json like it should. &nbsp;Lets explore this in more detail!</p>\n<p><strong>Scenario 1 - default setup</strong></p>\n<p>Lets take a look at the default appsettings.json for the base .NET Core site provided by the installer (or the Dancing Goat sample site), it should look something like this:</p>\n<object type=\"application/kenticocloud\" data-type=\"item\" data-rel=\"component\" data-codename=\"n72b96da7_1356_0153_d6e1_f485050d5aa8\"></object>\n<p>The above code block suggests that the logger should only be logging Error level events or above, which is great - it's probably the right setting for most setups and you might not even want to change this. &nbsp;But interestingly with this configuration, the logger still logs Information level events even though they are lower in severity. &nbsp;Shouldn't the logger ignore Information level events here? ü§î</p>\n<p><strong>Scenario 2 - disable all logging</strong></p>\n<p>We could even try taking this one step further, if we set the log level to None then the logger should effectively be disabled. &nbsp;All of the log levels below would be ignored and we shouldn't be getting any debug, information, events or exceptions logged. &nbsp;Lets try this with the following appsettings.json configuration:</p>\n<object type=\"application/kenticocloud\" data-type=\"item\" data-rel=\"component\" data-codename=\"n35223abb_8032_016c_b8f8_2788348dd3f6\"></object>\n<p>After calling the different event logger API methods, the end result is:</p>\n<object type=\"application/kenticocloud\" data-type=\"item\" data-rel=\"component\" data-codename=\"n67d1cabb_71c7_0132_50b8_f992b6f9d3d0\"></object>\n<p>So even if we disable all logging, the logger still logs everything done through the API. &nbsp;Interesting! ü§î</p>\n<p><strong>Scenario 3 - try different levels?</strong></p>\n<p>At this point I am starting to assume this is expected functionality by Xperience. &nbsp;Have I misunderstood the .NET Core logging API and the respective log levels? &nbsp;Has the Xperience team made a decision to ignore the level set and to log everything? &nbsp;Is it a bug in their implementation?</p>\n<p>Out of curiosity, I decided to try out all of the .NET Core logging levels - here are my findings:</p>\n<ul>\n  <li>Trace (Level 0) - breaks Page Builder, and logs all levels to error log.</li>\n  <li>Debug (Level 1) - breaks Page Builder, and logs all levels to error log.</li>\n  <li>Information (Level 2) - breaks Page Builder, and logs all levels to error log.</li>\n  <li>Warning (Level 3) - logs all levels to error log.</li>\n  <li>Error (Level 4) - logs all levels to error log.</li>\n  <li>Critical (Level 5) - logs all levels to error log.</li>\n  <li>None (Level 6) - logs all levels to error log.</li>\n</ul>\n<p>Something I didn't expect when lowering the log level (e.g. Trace, Debug, and Information), was that the Page Builder would break entirely when visiting the page tab. &nbsp;Instead you are greeted with an error message <strong>InvalidOperationException: User is not authorized to modify current page</strong>.</p>\n<object type=\"application/kenticocloud\" data-type=\"item\" data-rel=\"component\" data-codename=\"ef33d88c_30d7_01f4_c003_36bffab25282\"></object>\n<p>This is something I saw last week on <a href=\"https://twitter.com/ryano9791\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Ryan Overton</a>'s Twitch <a href=\"https://www.twitch.tv/videos/900701900?t=00h29m35s\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">stream</a>. &nbsp;If you haven't already - then do check out his streams, they're a great way of getting involved and learning more about Kentico Xperience! üëç</p>\n<p>With all this in mind, my current recommendation would be to leave the log level as the default value of Error. &nbsp;This will ensure your event logging is working correctly, and won't affect the page builder. &nbsp;I guess it's time to discuss this with Kentico Support üëÄ</p>","modular_content":[{"__typename":"kontent_item_code_block","elements":{"language":{"value":[{"codename":"javascript"}]},"code":{"value":"{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft\": \"Warning\",\n      \"Microsoft.Hosting.Lifetime\": \"Information\"\n    },\n    \"KenticoEventLog\": {\n      \"LogLevel\": {\n        \"Default\": \"Error\",\n        \"Microsoft.AspNetCore.Server.Kestrel\": \"None\"\n      }\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"CMSHashStringSalt\": \"5a9755b0-10a7-442a-99aa-2d754b1e71ee\",\n  \"ConnectionStrings\": {\n    \"CMSConnectionString\": \"Data Source=localhost;Initial Catalog=Kentico13Blank;Integrated Security=True;Persist Security Info=False;Connect Timeout=60;Encrypt=False;Current Language=English;\"\n  },\n  \"CMSCIRepositoryPath\": \"D:\\\\Projects\\\\liamgold\\\\K13\\\\Kentico13\\\\CMS\\\\App_Data\\\\CIRepository\"\n}"}},"system":{"id":"72b96da7-1356-0153-d6e1-f485050d5aa8","codename":"n72b96da7_1356_0153_d6e1_f485050d5aa8","type":"code_block"}},{"__typename":"kontent_item_code_block","elements":{"language":{"value":[{"codename":"javascript"}]},"code":{"value":"{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"None\",\n      \"Microsoft\": \"None\",\n      \"Microsoft.Hosting.Lifetime\": \"None\"\n    },\n    \"KenticoEventLog\": {\n      \"LogLevel\": {\n        \"Default\": \"None\",\n        \"Microsoft.AspNetCore.Server.Kestrel\": \"None\"\n      }\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"CMSHashStringSalt\": \"5a9755b0-10a7-442a-99aa-2d754b1e71ee\",\n  \"ConnectionStrings\": {\n    \"CMSConnectionString\": \"Data Source=localhost;Initial Catalog=Kentico13Blank;Integrated Security=True;Persist Security Info=False;Connect Timeout=60;Encrypt=False;Current Language=English;\"\n  },\n  \"CMSCIRepositoryPath\": \"D:\\\\Projects\\\\liamgold\\\\K13\\\\Kentico13\\\\CMS\\\\App_Data\\\\CIRepository\"\n}"}},"system":{"id":"35223abb-8032-016c-b8f8-2788348dd3f6","codename":"n35223abb_8032_016c_b8f8_2788348dd3f6","type":"code_block"}},{"__typename":"kontent_item_image","elements":{"image":{"name":"Image","type":"asset","value":[{"description":null,"height":380,"size":12136,"type":"image/png","name":"eventLog.PNG","url":"https://assets-us-01.kc-usercontent.com:443/1bb6bba8-9f04-4be8-88c3-46cbb47bbc97/245835d6-aaac-45de-b059-26923c8552df/eventLog.PNG","width":1046}]}},"system":{"id":"67d1cabb-71c7-0132-50b8-f992b6f9d3d0","codename":"n67d1cabb_71c7_0132_50b8_f992b6f9d3d0","type":"image"}},{"__typename":"kontent_item_image","elements":{"image":{"name":"Image","type":"asset","value":[{"description":null,"height":984,"size":100452,"type":"image/jpeg","name":"User is not authorized.jpeg","url":"https://assets-us-01.kc-usercontent.com:443/1bb6bba8-9f04-4be8-88c3-46cbb47bbc97/d465e236-e86a-43a1-bd25-4dee327052f8/User%20is%20not%20authorized.jpeg","width":1788}]}},"system":{"id":"ef33d88c-30d7-01f4-c003-36bffab25282","codename":"ef33d88c_30d7_01f4_c003_36bffab25282","type":"image"}}],"links":[]}},"system":{"id":"947fb07b-7510-4dab-b553-8f9642fcbd49"}}},"pageContext":{"slug":"net-core-event-logging-in-kentico-xperience-13"}},"staticQueryHashes":["3897982121"]}